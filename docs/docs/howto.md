# xscript如何工作
> 以下所有的函数和变量都在`core.XScriptInterpreter`中

## 块(block)
块是一组代码, 以块开始符(如`for`)开始,以`end`命令结束.

在`block`中记录了当前代码行所处的块, 以便能够更快遍历完块.

## 变量的命名标准
`testname`函数定义了xscript变量应怎样命名:

> 第一个字符应该是`a-z`或`A-Z`或`_`

> 剩余的字符在第一个字符的基础上允许`1-9`

## 变量代换符($, #, .)
美元符号(`$`), 井号(`#`), 和英文句号(`.`)都是变量代换符, 分别将变量转换为各种数据类型. 使用`replacevar`函数来替换在`var`中的变量.

  - `&`: 保持原来变量类型
  - `$`: 转换为str类型
  - `#`: 转换为int类型
  - `.`: 转换为float类型

> 使用`$`加数字如`$123`会返回str类型的123, 而不是数字123

在`2020-6-6`次提交中, 只要输入的参数符合如下正则表达式:

- `^(\+|-)?[0-9]*$`强制转换成int类型
- `^(\+|-)?[0-9]*\.[0-9]*$`强制转换成float类型

## 命令替换符(\[...\])
`[`和`]`是成对的命令替换符,使用`replacefunction`来替换.

命令替换符**仅仅**支持如下命令:

- addr
- gets
- xscript.

## xscript.
`xscript.`(不要忘记`.`)命令使用xscript函数来支持函数通过路径获取的功能, 支持获得函数和变量.

其间使用了一个`for`循环来遍历`lib`库的应用位置.

!!! warning "注意"
	在获取变量值的时候不能向`xscript`传递参数, 以免引起`... is not callable`错误

## 特殊的变量
解释器启动时创建的变量, 不能通过`let`语句赋值, 也不能通过`delete`语句删除. 但是可以正常使用, 即常量.

解释器定义的常量:

  - `true` - 逻辑值真
  - `false` - 逻辑值假
  - `null` - 等于`None`
  - `argv` - 运行时传递的命令行参数
  - `interpreter` - xscript解释器本身
  - `platform` - 操作系统的名称
  - `version` - xscript的版本号(十六进制)

!!! tips "贴示"
	`testname`函数也会检查一个字符串是否属于常量

!!! warning "警告"
	不在万不得已的情况下不要使用`interpreter`变量, 这可能会有风险
